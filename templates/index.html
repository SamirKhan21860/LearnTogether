{% extends "layout.html" %}

{% block title %}
Results
{% endblock %}

{% block index %}

<body class="bg-[rgb(240,228,252)] font-sans">

    

    <!-- Table-like bar for multiple pages -->
    <main class="flex flex-col h-full">
        <div class="navigationBar flex justify-center flex-col text-white m-4 md:flex-row">
            <div class="navItem cursor-pointer" onclick="showPage('announcements')">
                <div class="title p-2 bg-gray-600">Announcements</div>
                <div class="description p-2 bg-purple-500 md:block hidden">Important updates</div>
            </div>
            <div class="navItem cursor-pointer" onclick="showPage('classTiming')">
                <div class="title p-2 bg-gray-500">Class Timing</div>
                <div class="description p-2 bg-purple-600 md:block hidden">Organized templates</div>
            </div>
            <div class="navItem cursor-pointer" onclick="showPage('assignments')">
                <div class="title p-2 bg-gray-600">Assignments</div>
                <div class="description p-2 bg-purple-500 md:block hidden">Practical details</div>
            </div>
            <div class="navItem cursor-pointer" onclick="showPage('studyMaterials')">
                <div class="title p-2 bg-gray-500">Study Materials</div>
                <div class="description p-2 bg-purple-600 md:block hidden">Self-Study, e-Learning</div>
            </div>
            <div class="navItem cursor-pointer" onclick="showPage('scholarshipOpportunities')">
                <div class="title p-2 bg-gray-700">Scholarship Opportunities</div>
                <div class="description p-2 bg-purple-700 md:block hidden">Job Opportunities</div>
            </div>
        </div>

        <!-- Multiple pages layout -->
        <div id="switchPages" class="switchPages flex justify-center">

            <div id="page-announcements" class="page p-4 m-4 bg-purple-300 rounded-md flex items-start place-content-center hidden">
                <div class="p-4 bg-white rounded-full text-center">
                    <h2 class="title">Announcements</h2>
                </div>
            </div>

            <div id="page-classTiming" class="page p-4 m-4 bg-purple-400 rounded-md flex items-start place-content-center hidden">
                <div class="p-4 bg-white rounded-full text-center">
                    <h2>Class Timing</h2>
                </div>
            </div>

            <div id="page-assignments" class="page p-4 m-4 bg-purple-500 rounded-md flex items-start place-content-center">
                <div class="p-4 bg-white rounded-full text-center">
                    <h2>Assignments</h2>
                </div>

                <!-- Assignment Form -->
                <form action="/assign" method="post">
                    <div class="mb-4">
                        <input type="text" id="assignment_name" name="assignment_name" placeholder="Name"
                            class="shadow appearance-none border rounded-full text-center items-center w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline">
                    </div>
                    <div class="mb-4">
                        <textarea id="assignment_description" name="assignment_description" placeholder="Take a key Note"
                            class="shadow appearance-none border rounded-lg text-center items-center w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline"></textarea>
                    </div>
                    <div class="mb-6">
                        <input id="subject" name="subject" placeholder="Subject?"
                            class="shadow appearance-none border rounded-full text-center items-center w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline">
                    </div>
                    <div class="flex items-center justify-between">
                        <button type="submit"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">Add
                            Assignment</button>
                    </div>
                </form>
                
                <!-- Display Added Assignments -->
                <div class="mt-8">
                    <h3 class="text-xl font-bold mb-4">Added Assignments:</h3>
                    <table class="min-w-full table-auto">
                        <thead>
                            <tr>
                                <th class="border px-4 py-2">Assignment Name</th>
                                <th class="border px-4 py-2">Assignment Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for assignment in assignments %}
                            <tr>
                                <td class="border px-4 py-2">{{ assignment.name }}</td>
                                <td class="border px-4 py-2">{{ assignment.description }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

            </div>

            <div id="page-studyMaterials" class="page p-4 m-4 bg-purple-600 rounded-md flex items-start place-content-center hidden">
                <div class="p-4 bg-white rounded-full text-center">
                    <h2>Study Materials</h2>
                </div>
            </div>

            <div id="page-scholarshipOpportunities" class="page p-4 m-4 bg-purple-700 rounded-md flex items-start place-content-center hidden">
                <div class="p-4 bg-white rounded-full w-auto text-center">
                    <h2>Scholarship Opportunities</h2>
                </div>
            </div>

        </div>

    </main>



    <!-- Flash messages -->
    <!-- <div id="flash-container" class="absolute top-0 right-0">
    </div> -->

    <!-- Included the JavaScript Logic to handle flash messages dynamically -->
    <script>
        function showPage(pageId) {
                const switchPages = document.getElementById('switchPages');
                const pages = document.querySelectorAll('.page');

                pages.forEach(page => {
                    if (page.id === `page-${pageId}`) {
                        page.classList.remove('hidden');
                    } else {
                        page.classList.add('hidden');
                    }
                });
            }

        /* function showPage(pageId) {
            const switchPages = document.getElementById('switchPages');
            const selectedPage = document.getElementById(`page-${pageId}`);

            // Calculate the left offset to slide the selected page into view
            const leftOffset = selectedPage.offsetLeft;

            // Slide to the selected page
            switchPages.scrollTo({ left: leftOffset, behavior: 'smooth' });
        } */

        // Mapping of categories to Tailwind CSS classes
        const categoryStyles = {
            'error': 'bg-red-500',
            'info': 'bg-blue-500',
            'success': 'bg-green-500',
            'default': 'bg-gray-500'
        };

        // element dynamically using JavaScript if it doesn't exist in the HTML
        function showFlashMessage(message, category) {
            // Create or get the flash container
            var flashContainer = document.getElementById("flash-container");
            if (!flashContainer) {
                flashContainer = document.createElement("div");
                flashContainer.id = "flash-container";
                flashContainer.classList.add("absolute", "top-0", "right-0");
                document.body.appendChild(flashContainer);
            } else {
                // if flash_container exist then clear
                while (flashContainer.firstChild) {
                    flashContainer.removeChild(flashContainer.firstChild);
                }
            }

            // Now create a new flash message div element
            var flashMessage = document.createElement("div");
            flashMessage.classList.add(
                "m-4",
                "p-4",
                "hover:bg-opacity-50",
                "rounded-md",
                categoryStyles[category],
                "bg-green-500",
                "bg-opacity-75",
                "text-white",
                "transition-all",
                "duration-300",
                "ease-in-out",
                "text-white"
            );

            // Content of the flash message
            flashMessage.innerHTML = `<span class="mr-2">${message}</span><button class="text-white font-bold font-mono text-lg" onclick="closeFlashMessage(this.parentElement)">X</button>`;

            // Append the flash message to the container
            flashContainer.appendChild(flashMessage);

            // Using timeout to automatically remove the flash message after 5 seconds
            setTimeout(function () {
                closeFlashMessage(flashMessage);
            }, 3900);
        }

        function closeFlashMessage(flashMessage) {
            // Slide out the flash message
            flashMessage.style.transition = 'transform 0.3s ease-in-out';
            flashMessage.style.transform = 'translateX(110%)';

            // Remove the lement from the DOM after the transition completes
            flashMessage.addEventListener('transitionend', function () {
                flashMessage.remove();
            });
        }

        // Fetch and display Flask flash messages
        document.addEventListener("DOMContentLoaded", function () {
            // The .parse() will convert it to the object
            var flashMessages = JSON.parse('{{ get_flashed_messages() | tojson | safe }}');

            // Check if have any messages to show
            if (flashMessages) {
                flashMessages.forEach(function (message) {
                    // at index 0: message and index 1: category
                    showFlashMessage(message[0], message[1]);
                });
            }
        });

    </script>

</body>

{% endblock %}